/*
    Copyright (C) 2018 de4dot@gmail.com

    This file is part of Iced.

    Iced is free software: you can redistribute it and/or modify
    it under the terms of the GNU Lesser General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Iced is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Lesser General Public License for more details.

    You should have received a copy of the GNU Lesser General Public License
    along with Iced.  If not, see <https://www.gnu.org/licenses/>.
*/

#if !NO_NASM_FORMATTER && !NO_FORMATTER
using System.Collections.Generic;
using Xunit;

namespace Iced.UnitTests.Intel.FormatterTests.Nasm {
	public sealed class NasmFormatterTest64_NoMemSize_007 : FormatterTest {
		[Theory]
		[MemberData(nameof(Format_Data))]
		void Format(int index, InstructionInfo info, string formattedString) => FormatBase(index, info, formattedString, NasmFormatterFactory.Create_NoMemSize());
		public static IEnumerable<object[]> Format_Data => GetFormatData(infos, formattedStrings);

		static readonly InstructionInfo[] infos = InstructionInfos64_007.AllInfos;
		static readonly string[] formattedStrings = new string[InstructionInfos64_007.AllInfos_Length] {
			"a32 mov [fs:0x78563412],al",
			"mov [qword fs:0xf0debc9a78563412],ax",
			"a32 mov [fs:0x78563412],ax",
			"mov [qword fs:0xf0debc9a78563412],eax",
			"a32 mov [fs:0x78563412],eax",
			"mov [qword fs:0xf0debc9a78563412],rax",
			"a32 mov [fs:0x78563412],rax",
			"vcvtsi2ss xmm18,xmm14,{rn-sae},ebx",
			"vcvtsi2ss xmm18,xmm14,{rn-sae},rbx",
			"vcvtsi2sd xmm18,xmm14,{rn-sae},rbx",
			"vcvttss2si edx,xmm11,{sae}",
			"vcvttss2si rdx,xmm11,{sae}",
			"vcvttsd2si edx,xmm11,{sae}",
			"vcvttsd2si rdx,xmm11,{sae}",
			"vcvtss2si edx,xmm11,{rn-sae}",
			"vcvtss2si rdx,xmm11,{rn-sae}",
			"vcvtsd2si edx,xmm11,{rn-sae}",
			"vcvtsd2si rdx,xmm11,{rn-sae}",
			"vucomiss xmm18,xmm3,{sae}",
			"vucomisd xmm18,xmm3,{sae}",
			"vcomiss xmm18,xmm3,{sae}",
			"vcomisd xmm18,xmm3,{sae}",
			"vsqrtss xmm2{k3}{z},xmm6,xmm3,{ru-sae}",
			"vsqrtsd xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vaddss xmm2{k3}{z},xmm6,xmm3,{ru-sae}",
			"vaddsd xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vmulss xmm2{k3}{z},xmm6,xmm3,{ru-sae}",
			"vmulsd xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vcvtps2pd zmm2{k3}{z},ymm3,{sae}",
			"vcvtpd2ps ymm2{k3}{z},zmm3,{rn-sae}",
			"vcvtss2sd xmm18{k3}{z},xmm14,xmm3,{sae}",
			"vcvtsd2ss xmm18{k3}{z},xmm14,xmm3,{rn-sae}",
			"vcvtdq2ps zmm2{k3}{z},zmm3,{rn-sae}",
			"vcvtqq2ps ymm2{k3}{z},zmm3,{rn-sae}",
			"vcvtps2dq zmm2{k3}{z},zmm3,{rn-sae}",
			"vcvttps2dq zmm2{k3}{z},zmm3,{sae}",
			"vsubss xmm2{k3}{z},xmm6,xmm3,{ru-sae}",
			"vsubsd xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vminss xmm2{k3}{z},xmm6,xmm3,{sae}",
			"vminsd xmm2{k3},xmm6,xmm3,{sae}",
			"vdivss xmm2{k3}{z},xmm6,xmm3,{ru-sae}",
			"vdivsd xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vmaxss xmm2{k3}{z},xmm6,xmm3,{sae}",
			"vmaxsd xmm2{k3},xmm6,xmm3,{sae}",
			"vcvttps2udq zmm2{k3}{z},zmm3,{sae}",
			"vcvttpd2udq ymm2{k3}{z},zmm3,{sae}",
			"vcvttps2uqq zmm2{k3}{z},ymm3,{sae}",
			"vcvttpd2uqq zmm2{k3}{z},zmm3,{sae}",
			"vcvttss2usi edx,xmm11,{sae}",
			"vcvttss2usi rdx,xmm11,{sae}",
			"vcvttsd2usi edx,xmm11,{sae}",
			"vcvttsd2usi rdx,xmm11,{sae}",
			"vcvtps2udq zmm2{k3}{z},zmm3,{rn-sae}",
			"vcvtpd2udq ymm2{k3}{z},zmm3,{rn-sae}",
			"vcvtps2uqq zmm2{k3}{z},ymm3,{rn-sae}",
			"vcvtpd2uqq zmm2{k3}{z},zmm3,{rn-sae}",
			"vcvtss2usi edx,xmm11,{rn-sae}",
			"vcvtss2usi rdx,xmm11,{rn-sae}",
			"vcvtsd2usi edx,xmm11,{rn-sae}",
			"vcvtsd2usi rdx,xmm11,{rn-sae}",
			"vcvttps2qq zmm2{k3}{z},ymm3,{sae}",
			"vcvttpd2qq zmm2{k3}{z},zmm3,{sae}",
			"vcvtuqq2pd zmm2{k3}{z},zmm3,{rn-sae}",
			"vcvtudq2ps zmm2{k3}{z},zmm3,{rn-sae}",
			"vcvtuqq2ps ymm2{k3}{z},zmm3,{rn-sae}",
			"vcvtps2qq zmm2{k3}{z},ymm3,{rn-sae}",
			"vcvtpd2qq zmm2{k3}{z},zmm3,{rn-sae}",
			"vcvtusi2ss xmm18,xmm14,{rn-sae},ebx",
			"vcvtusi2ss xmm18,xmm14,{rn-sae},rbx",
			"vcvtusi2sd xmm18,xmm14,{rn-sae},rbx",
			"vcmpss k2{k3},xmm6,xmm3,{sae},0xa5",
			"vcmpsd k2{k3},xmm6,xmm3,{sae},0xa5",
			"vcvttpd2dq ymm2{k3}{z},zmm3,{sae}",
			"vcvtqq2pd zmm2{k3}{z},zmm3,{rn-sae}",
			"vcvtpd2dq ymm2{k3}{z},zmm3,{rn-sae}",
			"vscalefss xmm2{k3}{z},xmm6,xmm3,{ru-sae}",
			"vscalefsd xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vgetexpps zmm2{k3}{z},zmm3,{sae}",
			"vgetexppd zmm2{k3}{z},zmm3,{sae}",
			"vgetexpss xmm2{k3}{z},xmm6,xmm3,{sae}",
			"vgetexpsd xmm2{k3},xmm6,xmm3,{sae}",
			"vfmadd132ss xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfmadd132sd xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfmsub132ss xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfmsub132sd xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfnmadd132ss xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfnmadd132sd xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfnmsub132ss xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfnmsub132sd xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfmadd213ss xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfmadd213sd xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfmsub213ss xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfmsub213sd xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfnmadd213ss xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfnmadd213sd xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfnmsub213ss xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfnmsub213sd xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfmadd231ss xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfmadd231sd xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfmsub231ss xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfmsub231sd xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfnmadd231ss xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfnmadd231sd xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfnmsub231ss xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vfnmsub231sd xmm2{k3},xmm6,xmm3,{rz-sae}",
			"vexp2ps zmm2{k3}{z},zmm3,{sae}",
			"vexp2pd zmm2{k3}{z},zmm3,{sae}",
			"vrcp28ps zmm2{k3}{z},zmm3,{sae}",
			"vrcp28pd zmm2{k3}{z},zmm3,{sae}",
			"vrcp28ss xmm2{k3}{z},xmm6,xmm3,{sae}",
			"vrcp28sd xmm2{k3},xmm6,xmm3,{sae}",
			"vrsqrt28ps zmm2{k3}{z},zmm3,{sae}",
			"vrsqrt28pd zmm2{k3}{z},zmm3,{sae}",
			"vrsqrt28ss xmm2{k3}{z},xmm6,xmm3,{sae}",
			"vrsqrt28sd xmm2{k3},xmm6,xmm3,{sae}",
			"vrndscaleps zmm2{k3}{z},zmm3,{sae},0xa5",
			"vrndscalepd zmm2{k3}{z},zmm3,{sae},0xa5",
			"vrndscaless xmm18{k3},xmm14,xmm3,{sae},0xa5",
			"vrndscalesd xmm18{k3},xmm14,xmm3,{sae},0xa5",
			"vgetmantps zmm2{k3}{z},zmm3,{sae},0xa5",
			"vgetmantpd zmm2{k3}{z},zmm3,{sae},0xa5",
			"vgetmantss xmm18{k3},xmm14,xmm3,{sae},0xa5",
			"vgetmantsd xmm18{k3},xmm14,xmm3,{sae},0xa5",
			"vrangess xmm2{k3}{z},xmm6,xmm3,{sae},0xa5",
			"vrangesd xmm2{k3},xmm6,xmm3,{sae},0xa5",
			"vfixupimmss xmm2{k3}{z},xmm6,xmm3,{sae},0xa5",
			"vfixupimmsd xmm2{k3},xmm6,xmm3,{sae},0xa5",
			"vreduceps zmm2{k3}{z},zmm3,{sae},0xa5",
			"vreducepd zmm2{k3}{z},zmm3,{sae},0xa5",
			"vreducess xmm18{k3},xmm14,xmm3,{sae},0xa5",
			"vreducesd xmm18{k3},xmm14,xmm3,{sae},0xa5",
			"mov eax,es",
			"mov eax,cs",
			"mov eax,ss",
			"mov eax,ds",
			"mov eax,fs",
			"mov eax,gs",
			"mov al,cl",
			"mov dl,bl",
			"mov ah,ch",
			"mov dh,bh",
			"mov spl,bpl",
			"mov sil,dil",
			"mov r8b,r9b",
			"mov r10b,r11b",
			"mov r12b,r13b",
			"mov r14b,r15b",
			"mov ax,cx",
			"mov dx,bx",
			"mov sp,bp",
			"mov si,di",
			"mov r8w,r9w",
			"mov r10w,r11w",
			"mov r12w,r13w",
			"mov r14w,r15w",
			"mov eax,ecx",
			"mov edx,ebx",
			"mov esp,ebp",
			"mov esi,edi",
			"mov r8d,r9d",
			"mov r10d,r11d",
			"mov r12d,r13d",
			"mov r14d,r15d",
			"mov rax,rcx",
			"mov rdx,rbx",
			"mov rsp,rbp",
			"mov rsi,rdi",
			"mov r8,r9",
			"mov r10,r11",
			"mov r12,r13",
			"mov r14,r15",
			"fadd st0",
			"fadd st1",
			"fadd st2",
			"fadd st3",
			"fadd st4",
			"fadd st5",
			"fadd st6",
			"fadd st7",
			"mov rax,cr0",
			"mov rax,cr1",
			"mov rax,cr2",
			"mov rax,cr3",
			"mov rax,cr4",
			"mov rax,cr5",
			"mov rax,cr6",
			"mov rax,cr7",
			"mov rax,cr8",
			"mov rax,cr9",
			"mov rax,cr10",
			"mov rax,cr11",
			"mov rax,cr12",
			"mov rax,cr13",
			"mov rax,cr14",
			"mov rax,cr15",
			"mov rax,dr0",
			"mov rax,dr1",
			"mov rax,dr2",
			"mov rax,dr3",
			"mov rax,dr4",
			"mov rax,dr5",
			"mov rax,dr6",
			"mov rax,dr7",
			"mov rax,dr8",
			"mov rax,dr9",
			"mov rax,dr10",
			"mov rax,dr11",
			"mov rax,dr12",
			"mov rax,dr13",
			"mov rax,dr14",
			"mov rax,dr15",
			"movq mm0,mm1",
			"movq mm2,mm3",
			"movq mm4,mm5",
			"movq mm6,mm7",
			"vmovups xmm0{k1},xmm1",
			"vmovups xmm2{k1},xmm3",
			"vmovups xmm4{k1},xmm5",
			"vmovups xmm6{k1},xmm7",
			"vmovups xmm8{k1},xmm9",
			"vmovups xmm10{k1},xmm11",
			"vmovups xmm12{k1},xmm13",
			"vmovups xmm14{k1},xmm15",
			"vmovups xmm16{k1},xmm17",
			"vmovups xmm18{k1},xmm19",
			"vmovups xmm20{k1},xmm21",
			"vmovups xmm22{k1},xmm23",
			"vmovups xmm24{k1},xmm25",
			"vmovups xmm26{k1},xmm27",
			"vmovups xmm28{k1},xmm29",
			"vmovups xmm30{k1},xmm31",
			"vmovups ymm0{k1},ymm1",
			"vmovups ymm2{k1},ymm3",
			"vmovups ymm4{k1},ymm5",
			"vmovups ymm6{k1},ymm7",
			"vmovups ymm8{k1},ymm9",
			"vmovups ymm10{k1},ymm11",
			"vmovups ymm12{k1},ymm13",
			"vmovups ymm14{k1},ymm15",
			"vmovups ymm16{k1},ymm17",
			"vmovups ymm18{k1},ymm19",
			"vmovups ymm20{k1},ymm21",
			"vmovups ymm22{k1},ymm23",
			"vmovups ymm24{k1},ymm25",
			"vmovups ymm26{k1},ymm27",
			"vmovups ymm28{k1},ymm29",
			"vmovups ymm30{k1},ymm31",
			"vmovups zmm0{k1},zmm1",
			"vmovups zmm2{k1},zmm3",
			"vmovups zmm4{k1},zmm5",
			"vmovups zmm6{k1},zmm7",
			"vmovups zmm8{k1},zmm9",
			"vmovups zmm10{k1},zmm11",
			"vmovups zmm12{k1},zmm13",
			"vmovups zmm14{k1},zmm15",
			"vmovups zmm16{k1},zmm17",
			"vmovups zmm18{k1},zmm19",
			"vmovups zmm20{k1},zmm21",
			"vmovups zmm22{k1},zmm23",
			"vmovups zmm24{k1},zmm25",
			"vmovups zmm26{k1},zmm27",
			"vmovups zmm28{k1},zmm29",
			"vmovups zmm30{k1},zmm31",
			"knotw k0,k1",
			"knotw k2,k3",
			"knotw k4,k5",
			"knotw k6,k7",
			"bndcn bnd0,rax",
			"bndcn bnd1,rax",
			"bndcn bnd2,rax",
			"bndcn bnd3,rax",
			"mov cl,[rax]",
			"mov cl,[rax-0x12]",
			"mov cl,[rax-0x12345678]",
			"mov cl,[rip-0x12345678]",
			"mov cl,[eip-0x12345678]",
			"mov cl,[rax+0x12]",
			"mov cl,[rax+0x12345678]",
			"mov cl,[rip+0x12345678]",
			"mov cl,[eip+0x12345678]",
			"mov cl,[rax+rcx]",
			"mov cl,[rax+rcx*2]",
			"mov cl,[rax+rcx*4]",
			"mov cl,[rax+rcx*8]",
			"mov cl,[rax+rcx-0x12]",
			"mov cl,[rax+rcx*2-0x12]",
			"mov cl,[rax+rcx*4-0x12]",
			"mov cl,[rax+rcx*8-0x12]",
			"mov cl,[rax+rcx+0x12]",
			"mov cl,[rax+rcx*2+0x12]",
			"mov cl,[rax+rcx*4+0x12]",
			"mov cl,[rax+rcx*8+0x12]",
			"mov cl,[rax+rcx-0x12345678]",
			"mov cl,[rax+rcx*2-0x12345678]",
			"mov cl,[rax+rcx*4-0x12345678]",
			"mov cl,[rax+rcx*8-0x12345678]",
			"mov cl,[rax+rcx+0x12345678]",
			"mov cl,[rax+rcx*2+0x12345678]",
			"mov cl,[rax+rcx*4+0x12345678]",
			"mov cl,[rax+rcx*8+0x12345678]",
			"mov cl,[rcx*1-0x12345678]",
			"mov cl,[rbp+rcx*2-0x12]",
			"mov cl,[rbp+rcx*4-0x12345678]",
			"mov cl,[rcx*8-0x12345678]",
			"mov cl,[rcx*1+0x12345678]",
			"mov cl,[rbp+rcx*2+0x12]",
			"mov cl,[rbp+rcx*4+0x12345678]",
			"mov cl,[rcx*8+0x12345678]",
			"mov cl,[fs:rax]",
			"mov cl,[fs:rax-0x12]",
			"mov cl,[fs:rax-0x12345678]",
			"mov cl,[fs:rip-0x12345678]",
			"mov cl,[fs:eip-0x12345678]",
			"mov cl,[fs:rax+0x12]",
			"mov cl,[fs:rax+0x12345678]",
			"mov cl,[fs:rip+0x12345678]",
			"mov cl,[fs:eip+0x12345678]",
			"mov cl,[fs:rax+rcx]",
			"mov cl,[fs:rax+rcx*2]",
			"mov cl,[fs:rax+rcx*4]",
			"mov cl,[fs:rax+rcx*8]",
			"mov cl,[fs:rax+rcx-0x12]",
			"mov cl,[fs:rax+rcx*2-0x12]",
			"mov cl,[fs:rax+rcx*4-0x12]",
			"mov cl,[fs:rax+rcx*8-0x12]",
			"mov cl,[fs:rax+rcx+0x12]",
			"mov cl,[fs:rax+rcx*2+0x12]",
			"mov cl,[fs:rax+rcx*4+0x12]",
			"mov cl,[fs:rax+rcx*8+0x12]",
			"mov cl,[fs:rax+rcx-0x12345678]",
			"mov cl,[fs:rax+rcx*2-0x12345678]",
			"mov cl,[fs:rax+rcx*4-0x12345678]",
			"mov cl,[fs:rax+rcx*8-0x12345678]",
			"mov cl,[fs:rax+rcx+0x12345678]",
			"mov cl,[fs:rax+rcx*2+0x12345678]",
			"mov cl,[fs:rax+rcx*4+0x12345678]",
			"mov cl,[fs:rax+rcx*8+0x12345678]",
			"mov cl,[fs:rcx*1-0x12345678]",
			"mov cl,[fs:rbp+rcx*2-0x12]",
			"mov cl,[fs:rbp+rcx*4-0x12345678]",
			"mov cl,[fs:rcx*8-0x12345678]",
			"mov cl,[fs:rcx*1+0x12345678]",
			"mov cl,[fs:rbp+rcx*2+0x12]",
			"mov cl,[fs:rbp+rcx*4+0x12345678]",
			"mov cl,[fs:rcx*8+0x12345678]",
			"vsqrtss xmm2{k3}{z},xmm6,xmm3,{rn-sae}",
			"vsqrtss xmm2{k3}{z},xmm6,xmm3,{rd-sae}",
			"vsqrtss xmm2{k3}{z},xmm6,xmm3,{ru-sae}",
			"vsqrtss xmm2{k3}{z},xmm6,xmm3,{rz-sae}",
		};
	}
}
#endif
